(this.webpackJsonpDmitry_Avdeev123=this.webpackJsonpDmitry_Avdeev123||[]).push([[0],[,,function(e,a,t){e.exports={header:"DialoguesHeader_header__1SGyL",visuallyHidden:"DialoguesHeader_visuallyHidden__3POkp",hamburger:"DialoguesHeader_hamburger__2WfXv",bar:"DialoguesHeader_bar__13LSp",bar1:"DialoguesHeader_bar1__fvbKg",bar2:"DialoguesHeader_bar2__29tzD",bar3:"DialoguesHeader_bar3__2cLbz",bar4:"DialoguesHeader_bar4__1zNtJ",hamburger2:"DialoguesHeader_hamburger2__2EAWL",hamburger3:"DialoguesHeader_hamburger3__2Khek",hamburger4:"DialoguesHeader_hamburger4__q8D8x",bar5:"DialoguesHeader_bar5__2lNj4",checkbox4:"DialoguesHeader_checkbox4__8gdlC",messenger:"DialoguesHeader_messenger__36R73",searchButton:"DialoguesHeader_searchButton__1bBEn"}},function(e,a,t){e.exports={formInput:"FormInput_formInput__1CDjc",attachButton:"FormInput_attachButton__2ixoS",sendButton:"FormInput_sendButton__22Gjc",micButton:"FormInput_micButton__11YK-",cancelButton:"FormInput_cancelButton__bJpbb",inputButton:"FormInput_inputButton__2UzLN",dropOut:"FormInput_dropOut__2fyVW",dropOutContainer:"FormInput_dropOutContainer__2ygt-",attachItem:"FormInput_attachItem__1vaHt",attachImage:"FormInput_attachImage__21_M-",attachGeo:"FormInput_attachGeo__1PPvS",additionsBox:"FormInput_additionsBox__3dD64",additionsBoxUl:"FormInput_additionsBoxUl__1fz_N",image:"FormInput_image__J1Lbo",imageName:"FormInput_imageName__3ZK77",remove:"FormInput_remove__Ij8bW"}},function(e,a,t){e.exports={wrapper:"Profile_wrapper__l1aal",headerContainer:"Profile_headerContainer__3OGTq",header:"Profile_header__3KTnW",backButton:"Profile_backButton__PQK6j",editProfile:"Profile_editProfile__2nMoF",submitButton:"Profile_submitButton__3ZqAl",profile:"Profile_profile__3y5_H",avatar:"Profile_avatar__3XqJk",formContainer:"Profile_formContainer__3L5Z1",formLabel:"Profile_formLabel__26nnp",inputForm:"Profile_inputForm__2G2h8"}},,,,,function(e,a,t){e.exports={dialogue:"DialogueItem_dialogue__2rBXY",avatar:"DialogueItem_avatar__9XARq",wrapper:"DialogueItem_wrapper__3lnRQ",text:"DialogueItem_text__1WkGt",name:"DialogueItem_name__1rMup",time:"DialogueItem_time__31wNC",info:"DialogueItem_info__WVGza",message:"DialogueItem_message__3mEch",status:"DialogueItem_status__1zUFk"}},function(e,a,t){e.exports={messageWrap:"MessageItem_messageWrap__udvmP",inner:"MessageItem_inner__18rlh",messageItem:"MessageItem_messageItem__3ZnNZ",appearance:"MessageItem_appearance__3pxnC",message:"MessageItem_message__1157w",timestamp:"MessageItem_timestamp__30gC_",attachments:"MessageItem_attachments__15Y8W",attachment:"MessageItem_attachment__3ze9n",geolocation:"MessageItem_geolocation__2Inih",image:"MessageItem_image__1mB4Z"}},,,function(e,a,t){e.exports={messageForm:"MessageForm_messageForm__8PdEl",messagesList:"MessageForm_messagesList__2eLXd",header:"MessageForm_header__10-FU",chat:"MessageForm_chat__31JWU",inputForm:"MessageForm_inputForm__Q4V5O",dragNDropArea:"MessageForm_dragNDropArea__3m60l",activeZone:"MessageForm_activeZone__3Ogxo",dragNDropImage:"MessageForm_dragNDropImage__3N1tB"}},function(e,a,t){e.exports={container:"MainForm_container__1Ac2B",chatDisappear:"MainForm_chatDisappear__2crCV",chatAppearance:"MainForm_chatAppearance__2FfsV"}},,function(e,a,t){e.exports={header:"Header_header__1fnJb",Backbutton:"Header_Backbutton__3R9Gt",chatInfo:"Header_chatInfo__1j9it",avatarImage:"Header_avatarImage__3VzTK",senderInfo:"Header_senderInfo__2QORm",settingsButton:"Header_settingsButton__2eFvK"}},,function(e,a,t){e.exports={dialogues:"DialogueForm_dialogues__1D1Xl",dialogueList:"DialogueForm_dialogueList__QR6qv",empty:"DialogueForm_empty__ygZ6X"}},,,,,,,,,,,,,function(e,a,t){e.exports={createDialogueButton:"CreateDialogueButton_createDialogueButton__i92_8"}},,,function(e,a,t){e.exports=t(46)},,,,,function(e,a,t){},,,,,,function(e,a,t){},function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),s=t(25),c=(t(39),t(7)),o=t(11);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=t(26),i=t(27),m=t(32),u=t(28),g=t(33),d=t(18),_=t.n(d),p=t(2),h=t.n(p);function v(){return r.a.createElement("div",{className:h.a.header},r.a.createElement("input",{type:"checkbox",id:"checkbox4",className:h.a.checkbox4+" "+h.a.visuallyHidden}),r.a.createElement("label",{htmlFor:"checkbox4"},r.a.createElement("div",{className:h.a.hamburger+" "+h.a.hamburger4},r.a.createElement("span",{className:h.a.bar+" "+h.a.bar1}),r.a.createElement("span",{className:h.a.bar+" "+h.a.bar2}),r.a.createElement("span",{className:h.a.bar+" "+h.a.bar3}),r.a.createElement("span",{className:h.a.bar+" "+h.a.bar4}),r.a.createElement("span",{className:h.a.bar+" "+h.a.bar5}))),r.a.createElement("div",{className:h.a.messenger},"Dimanich Messenger"),r.a.createElement("div",{className:h.a.searchButton},r.a.createElement("img",{className:h.a.searchButton,src:"https://im0-tub-ru.yandex.net/i?id=48aff79a613972e36ec3fe0bb6886909&n=13",alt:"Settings Button"})))}var f=t(9),b=t.n(f),E=r.a.createContext(null);function N(e){var a=e.chat,t=new Date(a.lastMessage.time);return r.a.createElement(E.Consumer,null,(function(e){return r.a.createElement("div",{className:b.a.dialogue},r.a.createElement(c.b,{to:"/profile/".concat(a.id),style:{textDecoration:"none"}},r.a.createElement("img",{className:b.a.avatar,src:"https://im0-tub-ru.yandex.net/i?id=251924006823dd06b0ce06d758f3e6e2&n=13",alt:"avatar"})),r.a.createElement("div",{className:b.a.wrapper},r.a.createElement(c.b,{to:"/chat/".concat(a.id),style:{textDecoration:"none",color:"unset"}},r.a.createElement("div",{className:b.a.text},r.a.createElement("div",{className:b.a.name},a.title),r.a.createElement("div",{className:b.a.time},t.toLocaleString("ru",{hour:"numeric",minute:"numeric"}))),r.a.createElement("div",{className:b.a.info},r.a.createElement("div",{className:b.a.message},a.lastMessage.content||"Attachment"),r.a.createElement("div",{className:b.a.status},a.lastMessage.status)))))}))}var y=t(31),D=t.n(y);function I(e){var a=e.createHandler;return r.a.createElement("button",{onClick:a,className:D.a.createDialogueButton})}function k(e){var a=e.chats,t=[];return 0===a.length?t=r.a.createElement("div",{className:_.a.empty},"No messages yet"):a.forEach((function(e){var a=r.a.createElement(N,{chat:e});t.push(a)})),r.a.createElement("div",{className:_.a.dialogues},r.a.createElement(v,null),r.a.createElement("div",{className:_.a.dialogueList},t),r.a.createElement(E.Consumer,null,(function(e){return r.a.createElement(I,{createHandler:e.createHandler.bind(e)})})))}var F=t(12),B=t(13),x=t.n(B),S=t(16),C=t.n(S);function O(e){var a=e.details,t=e.clickBack;return r.a.createElement("div",{className:C.a.header},r.a.createElement(c.b,{to:"/"},r.a.createElement("button",{onClick:t,className:C.a.Backbutton},"Back")),r.a.createElement("div",{className:C.a.chatInfo},r.a.createElement(c.b,{to:"/profile/".concat(a.id)},r.a.createElement("img",{className:C.a.avatarImage,src:"https://im0-tub-ru.yandex.net/i?id=251924006823dd06b0ce06d758f3e6e2&n=13",alt:"Avatar"})),r.a.createElement("div",{className:C.a.senderInfo},r.a.createElement("div",null,a.title),r.a.createElement("div",null,"Status: unknown"))),r.a.createElement("input",{type:"image",className:C.a.settingsButton,src:"https://im0-tub-ru.yandex.net/i?id=48aff79a613972e36ec3fe0bb6886909&n=13",alt:"settings button"}))}var M=t(19),H=t(3),P=t.n(H);function w(e){var a=r.a.useRef(null),t=e.messageHandler,n=Object(F.a)(e.dragFiles,2),s=n[0],c=n[1],o=r.a.useState(null),l=Object(F.a)(o,2),i=l[0],m=l[1],u=r.a.useState(null),g=Object(F.a)(u,2),d=g[0],_=g[1],p=r.a.useState("mic"),h=Object(F.a)(p,2),v=h[0],f=h[1],b=null,E=null,N=r.a.useRef(null),y=function(){var e=a.current.value.trim();(d||""!==e)&&(a.current.value="",t(e,null,null,d)),_(null)},D=function(e){var a=d.list;a.splice(e,1),a.length?_({type:d.type,list:a}):_(null)};if(s){var I=d||{};I.type="image",I.list=[{name:s.name,path:window.URL.createObjectURL(s),file:s}],I!==d&&_(I),c(null)}a.current&&""!==a.current.value||d?"send"!==v&&f("send"):"mic"!==v&&f("mic");return d&&(b={height:"100px"},E=d.list.map((function(e,a){return r.a.createElement(L,{key:a,remove:D.bind(null,a),type:d.type,addition:e})}))),r.a.createElement("div",{className:P.a.container},r.a.createElement("div",{className:P.a.formInput},r.a.createElement("div",{className:P.a.dropOut,style:i},r.a.createElement("div",{className:P.a.dropOutContainer},r.a.createElement("div",{onClick:function(){N.current.click()},className:"".concat(P.a.attachItem," ").concat(P.a.attachImage)},r.a.createElement("input",{onChange:function(e){!function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.target.files;if(!n.length)return!1;var r=!1;n=Object(M.a)(n).map((function(e){return e.size>5242880&&(r=!0),{name:e.name,path:window.URL.createObjectURL(e),file:e}})),r?t&&t("\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0444\u0430\u0439\u043b"):(d&&(n=[].concat(Object(M.a)(d.list),Object(M.a)(n))),d&&"image"!==d.type?t&&t("\u0412\u044b \u0443\u0436\u0435 \u0434\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u043e\u0439 \u0442\u0438\u043f \u0444\u0430\u0439\u043b\u043e\u0432"):(n.length>10&&(n=n.slice(0,10)),a(n)))}(e,(function(e){_({type:"image",list:e})}))},ref:N,type:"file",multiple:!0,style:{display:"none"}})),r.a.createElement("div",{onClick:function(){!function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("geolocation"in navigator){navigator.geolocation.getCurrentPosition(e,console.log,{enableHighAccuracy:!0,maximumAge:3e4,timeout:27e3})}else a&&a("Permisition denied")}((function(e){var a=e.coords,t=a.latitude,n=a.longitude,r="https://yandex.ru/maps/?ll=".concat(n,"%2C").concat(t,"&z=15");_({type:"geolocation",list:[{name:"Geolocation",path:r,latitude:t,longitude:n}]})}))},className:"".concat(P.a.attachItem," ").concat(P.a.attachGeo)}))),r.a.createElement("div",{onClick:function(){!i&&m({width:"120px"}),i&&m(null)},className:P.a.attachButton}),r.a.createElement("input",{onChange:function(e){e.target.value.length>0?f("send"):0===e.target.value.length&&f("mic")},onKeyPress:function(e){13===e.charCode&&y()},ref:a,placeholder:"Enter message..."}),r.a.createElement(j,{submit:y,type:v})),r.a.createElement("div",{style:b,className:P.a.additionsBox},r.a.createElement("ul",{className:P.a.additionsBoxUl},E)))}function L(e){var a=e.remove,t=e.type,n=e.addition,s={backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center center",height:"65px"};switch(t){case"image":s.backgroundImage="url(".concat(n.path,")");break;case"geolocation":s.backgroundImage="url(https://image.flaticon.com/icons/svg/854/854878.svg)"}return r.a.createElement("li",null,r.a.createElement("div",{onClick:a,className:P.a.remove},"-"),r.a.createElement("div",{style:s,className:P.a.image}),r.a.createElement("span",{className:P.a.imageName},n.name))}function j(e){var a=e.submit,t=null;switch(e.type){case"mic":t=r.a.createElement("div",{className:"".concat(P.a.inputButton," ").concat(P.a.micButton)});break;case"send":t=r.a.createElement("div",{onClick:a,className:"".concat(P.a.sendButton)},"Send")}return t}var A=t(10),R=t.n(A);function J(e){var a=e.inner,t=a.content,n=a.time,s=new Date(n),c=!1,o=[];if("attachments"in e.inner){var l=e.inner.attachments;c=!0,l.list.forEach((function(e){var a=r.a.createElement(W,{type:l.type,attachment:e});o.push(a)}))}return r.a.createElement("div",{className:R.a.messageWrap},r.a.createElement("div",{className:R.a.messageItem},r.a.createElement("div",{className:R.a.inner},r.a.createElement("div",{className:R.a.message},t),r.a.createElement("div",{className:R.a.attachments},c&&o)),r.a.createElement("div",{className:R.a.timestamp},s.toLocaleString("ru",{hour:"numeric",minute:"numeric"}))))}function W(e){var a=e.attachment,t=a.name,n=a.path,s=null;switch(e.type){case"geolocation":var c=e.attachment,o=c.latitude,l=c.longitude,i="https://static-maps.yandex.ru/1.x/?ll=".concat(l,",").concat(o,"&spn=0.016457,0.00619&l=map&size=300,300"),m={backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center center",height:"300px",width:"300px"};m.backgroundImage="url(".concat(i,")"),s=r.a.createElement("div",null,r.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("div",{style:m,className:"".concat(R.a.attachment)})));break;case"image":s=r.a.createElement("img",{alt:t,src:n,className:R.a.image})}return s}function z(e){var a=e.messages,t=e.details,n=e.style,s=r.a.useState(!1),c=Object(F.a)(s,2),o=c[0],l=c[1],i=r.a.useState(null),m=Object(F.a)(i,2),u=m[0],g=m[1];if(null===t)return"";var d=[];return a.forEach((function(e){var a=r.a.createElement(J,{inner:e});d.push(a)})),r.a.createElement("div",{onDrop:function(e){e.preventDefault(),e.stopPropagation(),l(!1),g(e.dataTransfer.files[0])},onDragOver:function(e){e.preventDefault(),e.stopPropagation(),l(!0)},onDragLeave:function(){l(!1)},style:n,className:x.a.messageForm},r.a.createElement("div",{className:"".concat(x.a.dragNDropArea," ").concat(o&&x.a.activeZone)},r.a.createElement("div",{className:x.a.dragNDropImage})),r.a.createElement(E.Consumer,null,(function(e){return r.a.createElement(O,{details:t,clickBack:e.closeDialogue.bind(e,"MessageForm")})})),r.a.createElement("div",{className:x.a.chat},r.a.createElement("div",{className:x.a.messagesList},d)),r.a.createElement("div",{className:x.a.inputForm},r.a.createElement(E.Consumer,null,(function(e){return r.a.createElement(w,{messageHandler:e.messageHandler.bind(e),dragFiles:[u,g]})}))))}var U=t(4),G=t.n(U);function Z(e){var a=e.style;return r.a.createElement("div",{className:G.a.wrapper,style:a},r.a.createElement("div",{className:G.a.headerContainer},r.a.createElement("div",{className:G.a.header},r.a.createElement(c.b,{to:"/",style:{textDecoration:"none",color:"unset"}},r.a.createElement("button",{className:G.a.backButton},"Back")),r.a.createElement("button",{className:G.a.submitButton},"Edit Profile"))),r.a.createElement("div",{className:G.a.profile},r.a.createElement("img",{className:G.a.avatar,src:"https://im0-tub-ru.yandex.net/i?id=251924006823dd06b0ce06d758f3e6e2&n=13",alt:"avatar"}),r.a.createElement("div",{className:G.a.formContainer},r.a.createElement("div",{className:G.a.formLabel},"Full name"),r.a.createElement("input",{className:G.a.inputForm,placeholder:"Avdeev Dmitry"})),r.a.createElement("div",{className:G.a.formContainer},r.a.createElement("div",{className:G.a.formLabel},"Username"),r.a.createElement("input",{className:G.a.inputForm,placeholder:"Dimka1111"})),r.a.createElement("div",{className:G.a.formContainer},r.a.createElement("div",{className:G.a.formLabel},"Status"),r.a.createElement("input",{className:G.a.inputForm,placeholder:"No status"}))))}var K=t(14),X=t.n(K),q=function(e){function a(e){var t;Object(l.a)(this,a);var n=(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).parseStorage();return t.state={chats:n.chats,messages:n.messages,chatCounter:n.chatCounter,currentDialogue:null,flag:0,frameStyles:{MessageForm:{animationName:X.a.chatDisappear,display:"none"},Profile:{animationName:X.a.chatDisappear,display:"none"}}},t}return Object(g.a)(a,e),Object(i.a)(a,[{key:"parseStorage",value:function(){var e={chats:JSON.parse(localStorage.getItem("chats")),messages:JSON.parse(localStorage.getItem("messages")),chatCounter:JSON.parse(localStorage.getItem("chatCounter"))};return e.chats||(e.chats=[],e.messages={},e.chatCounter=0),e}},{key:"openDialogue",value:function(e){var a=this.state;a.frameStyles.MessageForm={animationName:X.a.chatAppearance,display:"flex"},a.currentDialogue=e,a!==this.state&&this.setState(a)}},{key:"closeDialogue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.state;e?a.frameStyles[e]={animationName:X.a.chatDisappear}:Object.keys(a.frameStyles).forEach((function(e){a.frameStyles[e]={animationName:X.a.chatDisappear,display:"flex"}})),a!==this.state&&this.setState(a)}},{key:"messageHandler",value:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.state,s=r.currentDialogue,c=r.messages;c||(c={}),t&&(c[(s=t)-1]=[]);var o={id:"test",content:e,amISender:!0,time:a||new Date,status:"sent"};if(n){o.attachments=n,!0;var l=new FormData;l.append(Attr.type,n.file),fetch("https://tt-front.now.sh/upload",{method:"POST",body:l}).then((function(){})).catch(console.log)}c[s-1].push(o),this.setState(c),t||this.setLastMessage(),localStorage.setItem("messages",JSON.stringify(c))}},{key:"createHandler",value:function(){var e=this.state,a=e.chats,t=e.chatCounter,n=prompt("Enter person name"),r=prompt("Write a message");t+=1,this.messageHandler(r,new Date,t);var s=this.state.messages[t-1];a.push({id:t,title:n,is_group:!1,host:"Avdeev Dmitry",lastMessage:s[s.length-1]}),this.setState({chats:a,chatCounter:t}),this.setLastMessage(t),localStorage.setItem("chats",JSON.stringify(a)),localStorage.setItem("chatCounter",JSON.stringify(t))}},{key:"setLastMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.state,t=a.messages,n=a.chats,r=this.state.currentDialogue;e&&(r=e);var s=t[r-1];n[r-1].lastMessage=s[s.length-1],this.setState(n),localStorage.setItem("chats",JSON.stringify(n))}},{key:"openProfile",value:function(){var e=this.state;e.frameStyles.Profile={animationName:X.a.chatAppearance,display:"flex"},e!==this.state&&this.setState(e)}},{key:"pageRouter",value:function(){var e=this.props.location.pathname;switch(!0){case/chat\/\d\/?$/.test(e):var a=parseInt(e.match(/\d+/),10);this.openDialogue(a);break;case/profile\/\d\/?$/.test(e):this.openProfile();break;case 0===this.state.flag:this.state.flag=1;break;default:this.closeDialogue()}}},{key:"render",value:function(){this.pageRouter();var e=this.state;return r.a.createElement(E.Provider,{value:this},r.a.createElement("div",{className:X.a.container},r.a.createElement(k,{chats:e.chats}),r.a.createElement(z,{style:e.frameStyles.MessageForm,details:e.currentDialogue&&e.chats[e.currentDialogue-1],messages:e.currentDialogue&&e.messages[e.currentDialogue-1]}),r.a.createElement(Z,{style:e.frameStyles.Profile})))}}]),a}(r.a.Component);t(45);Object(s.render)(r.a.createElement(c.a,null,r.a.createElement(o.a,{path:"/",component:q})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[34,1,2]]]);
//# sourceMappingURL=main.5182bedc.chunk.js.map